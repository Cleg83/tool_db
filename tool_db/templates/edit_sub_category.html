{% extends "base.html" %}
{% block content %}

    <h3 class="white-text center-align">Edit {{ subcategory.sub_category_name }}</h3>

    <div class="row">
        <form class="col s8 offset-s2 teal lighten-3" method="POST" action="{{ url_for('edit_sub_category', subcategory_id=subcategory.id) }}">
            <!-- subcategory name input -->
            <div class="row content-wrapper">
                <div class="input-field col s10 offset-s1 grey lighten-4">
                    <i class="fa-solid fa-folder-tree prefix"></i>
                    <input id="subcategory_name" name="subcategory_name" value="{{ subcategory.sub_category_name }}"
                        pattern="^(?!\s*$)[a-zA-Z0-9\s]+$" minlength="3" maxlength="50" type="text" class="validate" required>
                    <label for="subcategory_name" class="active">Category Name</label>
                </div>
            </div>
            <!-- main category select -->
            <div class="row">
                <div class="input-field col s10 offset-s1 grey lighten-4">
                    <i class="fa-solid fa-folder-open prefix"></i>
                    <select id="main_category" name="main_category" class="validate" required>
                        <option value="" disabled {% if not subcategory.main_category_id %}selected{% endif %}>Choose Main Category</option>
                        {% for category in main_categories %}
                            <option value="{{ category.id }}" {% if category.id == subcategory.main_category_id %}selected{% endif %}>
                                {{- category.main_category_name }}
                            </option>
                        {% endfor %}
                    </select>
                    <label for="main_category"><span class="sr-only">Main Category</span></label>
                </div>
            </div>
            <!-- tool list -->
            <h5 class="center">Tools</h4>
                <div class="row valign-wrapper">
                    {% for tool in tools %}
                        <div class="input-field col s2 offset-s1 grey lighten-4">
                            <a class="center" href="{{ url_for('tool', tool_id=tool.id) }}">
                                <p>{{ tool.tool_name }}</p>
                            </a>
                            <div id="tiny-btn-container" class="col s12">
                                <a href="{{ url_for('edit_tool', tool_id=tool.id) }}" class="edit-small left"><small>Edit</small></a>
                                <a href="#modal-{{ tool.id }}" class="delete-small right modal-trigger"><small>Delete</small></a>
                            </div>
                        </div>
                    {% endfor %}
                </div>
            <!-- submit button -->
            <div class="row">
                <div class="col s10 offset-s1 center-align">
                    <button type="submit" class="btn-large grey lighten-4 black-text form-btn">
                        Save changes <i class="fa-solid fa-folder-plus right"></i>
                    </button>
                </div>
            </div>
        </form>
    </div>

    <!-- delete tool modal -->
    {% for tool in tools %}
        <div id="modal-{{ tool.id }}" class="modal">
            <div class="modal-content">
                <h4>Are you sure you want to delete this tool?</h4>
                <p>This action cannot be undone!</p>
            </div>
            <div class="modal-footer">
                <a href="{{ url_for('delete_tool', tool_id=tool.id) }}" class="btn delete-button">Delete</a>
                <a href="#!" class="modal-close btn edit-button">Cancel</a>
            </div>
        </div>
    {% endfor %}

{% endblock %}